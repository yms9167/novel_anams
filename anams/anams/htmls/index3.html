<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>알고리즘 성능 비교기</title>
    <!-- Tailwind CSS CDN을 로드합니다. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter 폰트를 사용합니다. -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .container {
            max-width: 1024px;
        }
        .code-box {
            height: 250px;
            min-height: 100px;
            overflow-y: auto;
            resize: vertical;
        }
        .result-box {
            min-height: 80px;
            overflow-y: auto;
        }
        /* placeholder 스타일 */
        [placeholder] {
            font-style: italic;
            color: #9ca3af;
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4">

    <!-- 메인 컨테이너 -->
    <div class="container bg-white p-8 rounded-2xl shadow-xl w-full">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-6">
            알고리즘 성능 비교 도구
        </h1>

        <!-- 안내 메시지 -->
        <p class="text-center text-gray-600 mb-8">
            아래 두 코드 상자에 비교하고 싶은 자바스크립트 함수를 입력하세요.<br>
            함수는 <code>(arr) => { ... }</code> 형식이어야 합니다.
        </p>

        <!-- 코드 입력 섹션 -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <!-- 비효율적 코드 상자 -->
            <div class="p-6 rounded-xl shadow-inner border border-red-200 bg-red-50">
                <h2 class="text-xl font-bold text-red-700 mb-2">비효율적 코드</h2>
                <textarea id="codeNaive" class="w-full p-2 border rounded-lg code-box font-mono text-sm focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="예시:
function findDuplicatesNaive(arr) {
    const n = arr.length;
    for (let i = 0; i < n; i++) {
        for (let j = i + 1; j < n; j++) {
            if (arr[i] === arr[j]) {
                return true;
            }
        }
    }
    return false;
}
"></textarea>
            </div>

            <!-- 최적화된 코드 상자 -->
            <div class="p-6 rounded-xl shadow-inner border border-green-200 bg-green-50">
                <h2 class="text-xl font-bold text-green-700 mb-2">최적화된 코드</h2>
                <textarea id="codeOptimized" class="w-full p-2 border rounded-lg code-box font-mono text-sm focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="예시:
function findDuplicatesOptimized(arr) {
    const seen = new Set();
    for (const num of arr) {
        if (seen.has(num)) {
            return true;
        }
        seen.add(num);
    }
    return false;
}
"></textarea>
            </div>
        </div>

        <!-- 입력 및 실행 버튼 섹션 -->
        <div class="flex flex-col sm:flex-row items-center justify-center gap-4 mb-6 p-4 rounded-xl bg-gray-50 border">
            <div class="flex items-center gap-4">
                <label for="arraySize" class="font-semibold text-gray-700">배열 크기:</label>
                <input type="number" id="arraySize" value="1000000" min="1" class="w-32 p-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="flex items-center gap-2">
                <input type="checkbox" id="addDuplicate" class="form-checkbox h-5 w-5 text-blue-600 rounded">
                <label for="addDuplicate" class="text-gray-700">중복 숫자 포함</label>
            </div>
            <button id="runBtn" class="bg-blue-600 text-white font-semibold py-3 px-6 rounded-xl shadow-md hover:bg-blue-700 transition duration-200 ease-in-out transform hover:scale-105">
                성능 비교 실행
            </button>
        </div>

        <!-- 결과 출력 섹션 -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="bg-gray-100 p-4 rounded-xl shadow-inner border border-gray-200">
                <h2 class="text-lg font-bold text-gray-700 mb-2">비효율적 코드 결과</h2>
                <div id="resultNaive" class="result-box p-2 bg-white rounded-lg border border-gray-200 font-mono text-sm text-gray-800"></div>
            </div>
            <div class="bg-gray-100 p-4 rounded-xl shadow-inner border border-gray-200">
                <h2 class="text-lg font-bold text-gray-700 mb-2">최적화된 코드 결과</h2>
                <div id="resultOptimized" class="result-box p-2 bg-white rounded-lg border border-gray-200 font-mono text-sm text-gray-800"></div>
            </div>
        </div>
    </div>

    <script>
        // DOM 요소 가져오기
        const codeNaiveEl = document.getElementById('codeNaive');
        const codeOptimizedEl = document.getElementById('codeOptimized');
        const arraySizeInput = document.getElementById('arraySize');
        const addDuplicateCheckbox = document.getElementById('addDuplicate');
        const runBtn = document.getElementById('runBtn');
        const resultNaiveEl = document.getElementById('resultNaive');
        const resultOptimizedEl = document.getElementById('resultOptimized');

        // 결과를 출력하는 함수
        function logResult(element, message) {
            element.innerHTML = `<p>${message}</p>`;
        }

        // 주어진 코드를 평가하고 실행 시간을 측정하는 함수
        function runCode(code, arr, resultEl) {
            // 결과 상자 초기화
            logResult(resultEl, "실행 중...");
            
            try {
                // 함수를 안전하게 실행하기 위해 Function 생성자 사용
                const func = new Function('arr', `${code}; return arr;`);

                const startTime = performance.now();
                // 코드를 5회 실행하여 평균 시간을 측정 (안정성 향상)
                for (let i = 0; i < 5; i++) {
                    func(arr);
                }
                const endTime = performance.now();
                
                const avgTime = (endTime - startTime) / 5;
                logResult(resultEl, `성공! 평균 실행 시간: ${avgTime.toFixed(6)}ms`);
            } catch (e) {
                logResult(resultEl, `<span class="text-red-500 font-semibold">오류 발생:</span> ${e.message}`);
            }
        }

        // '실행' 버튼 클릭 이벤트 리스너
        runBtn.addEventListener('click', () => {
            const codeNaive = codeNaiveEl.value;
            const codeOptimized = codeOptimizedEl.value;
            const arraySize = parseInt(arraySizeInput.value, 10);
            const addDuplicate = addDuplicateCheckbox.checked;

            if (isNaN(arraySize) || arraySize <= 0) {
                alert("배열 크기를 1 이상의 숫자로 입력해주세요.");
                return;
            }

            // 테스트용 배열 생성
            const testArray = Array.from({ length: arraySize }, (_, i) => i + 1);
            if (addDuplicate && arraySize > 1) {
                // 중복을 중간에 추가
                testArray.push(Math.floor(arraySize / 2) + 1);
            }

            // 각 함수 실행
            runCode(codeNaive, testArray, resultNaiveEl);
            runCode(codeOptimized, testArray, resultOptimizedEl);
        });
    </script>
</body>
</html>
